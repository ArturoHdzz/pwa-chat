<app-chat-header
  [title]="'Chat'"
  [timeLabel]="'11:15'"
  (organizationChange)="onOrgChange($event)"
>
</app-chat-header>
<ion-content class="bg-gray-100">

  <!-- Sección Usuarios -->
  <div class="px-4 pt-4">
    <h3 class="text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2">
      Sugeridos
    </h3>

    <div class="bg-white rounded-2xl shadow-sm overflow-hidden">
      <button
        *ngFor="let u of data?.users"
        type="button"
        (click)="toggleUser(u)"
        class="w-full flex items-center px-4 py-3 transition-colors duration-150"
        [ngClass]="{
          'bg-gray-50': isUserSelected(u),
          'active:bg-gray-50': !isUserSelected(u)
        }"
      >
        <!-- Avatar con iniciales -->
        <div class="relative mr-3 m-2">
          <div
            class="h-10 w-10 rounded-full flex items-center justify-center text-sm font-semibold text-white "
            [ngClass]="isUserSelected(u) ? 'bg-emerald-900' : 'bg-emerald-800'"
          >
            {{ (u.display_name || u.name)?.charAt(0) | uppercase }}
          </div>

          <!-- Indicador de selección -->
          <div
            class="absolute -bottom-1 -right-1 h-4 w-4 rounded-full border border-white"
            [ngClass]="isUserSelected(u) ? 'bg-emerald-500' : 'bg-gray-300'"
          ></div>
        </div>

        <!-- Texto usuario -->
        <div class="flex-1 text-left">
          <p class="text-[15px] font-medium text-gray-900 leading-tight">
            {{ u.display_name }}
          </p>
          <p class="text-xs text-gray-500">
            {{ u.name }} {{ u.apellido_paterno }} {{ u.apellido_materno }}
          </p>
        </div>
      </button>
    </div>
  </div>

  <!-- Sección Grupos -->
  <div class="px-4 pt-6 pb-16">
    <h3 class="text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2">
      Grupos
    </h3>

    <div class="bg-white rounded-2xl shadow-sm overflow-hidden">
      <button
        *ngFor="let g of data?.groups"
        type="button"
        (click)="toggleGroup(g)"
        class="w-full flex items-center px-4 py-3 transition-colors duration-150"
        [ngClass]="{
          'bg-gray-50': isGroupSelected(g),
          'active:bg-gray-50': !isGroupSelected(g)
        }"
      >
        <!-- Avatar grupo -->
        <div class="relative mr-3 m-2">
          <div
            class="h-10 w-10 rounded-full flex items-center justify-center text-sm font-semibold text-white"
            [ngClass]="isGroupSelected(g) ? 'bg-indigo-600' : 'bg-indigo-400'"
          >
            {{ g.name?.charAt(0) | uppercase }}
          </div>

          <div
            class="absolute -bottom-1 -right-1 h-4 w-4 rounded-full border border-white"
            [ngClass]="isGroupSelected(g) ? 'bg-indigo-500' : 'bg-gray-300'"
          ></div>
        </div>

        <!-- Texto grupo -->
        <div class="flex-1 text-left">
          <p class="text-[15px] font-medium text-gray-900 leading-tight">
            {{ g.name }}
          </p>
          <p class="text-xs text-gray-500">
            {{ g.description }}
          </p>
        </div>
      </button>
    </div>
  </div>

  <!-- Botón para crear conversación -->
  <div
    class="fixed left-0 right-0 bottom-4 px-4"
    *ngIf="hasSelection()"
  >
    <button
      type="button"
      class="w-full h-7 rounded-full bg-emerald-900 text-white py-3 text-sm font-semibold shadow-md active:bg-emerald-800 disabled:opacity-40 disabled:cursor-not-allowed"
      (click)="startConversation()"
    >
      Iniciar conversación
    </button>
  </div>

</ion-content>

